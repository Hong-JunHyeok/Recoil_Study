# About Recoil

# ê³µì‹ ë¬¸ì„œ [ë§í¬](https://recoiljs.org/ko/)

![image](https://miro.medium.com/max/2000/1*0SkjAGdVWYe4ja5Qu4DeJg.jpeg)

> **ë¦¬ì½”ì¼ì€ ë¦¬ì•¡íŠ¸ë¥¼ ìœ„í•œ ìƒíƒœê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ í˜ì´ìŠ¤ë¶ì—ì„œ ì œì‘ì„ í•˜ê³ ìˆìœ¼ë©°, í˜„ì œ ë§ì€ í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œìë“¤ì´ ê¸°ëŒ€í•˜ê³  ìˆëŠ” ê¸°ìˆ ì´ê¸°ë„ í•˜ë‹¤.**

ì´ ë ˆí¬ì§€í† ë¦¬ëŠ” ì–´ë–»ê²Œí•˜ë©´ ë¦¬ì•¡íŠ¸ì—ì„œ ë¦¬ì½”ì¼ì„ ì˜ ì‚¬ìš©í•  ìˆ˜ ìˆì„ê¹Œì— ëŒ€í•œ ê³ ë¯¼ì˜ í”ì ì´ë‹¤.
`Redux`, `MobX`ë“± ë‹¤ì–‘í•œ ìƒíƒœê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì¨ë´¤ì§€ë§Œ ë‘˜ë‹¤ ê²°êµ­ì—ëŠ” ì™„ì „íˆ ë‚˜ë¥¼ ë§Œì¡±ì‹œí‚¤ì§€ ëª»í–ˆë‹¤...(ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ì–´ë– í•œ ë¬¸ì œê°€ ìˆì—ˆë˜ê²ƒì€ ì•„ë‹ˆë‹¤.) ê·¸ì € ìƒíƒœê´€ë¦¬ íŒ¨í„´ë“¤ì´ ë§˜ì— ë“¤ì§€ ì•Šì•˜ê³  ë‚˜ëŠ” ê¾¸ì—­ê¾¸ì—­ ì“¸ ìˆ˜ ë°–ì— ì—†ì—ˆë‹¤. ê·¸ëŸ¬ë˜ì¤‘ **í˜ì´ìŠ¤ë¶ì´ ìƒˆë¡œìš´ ì†”ë£¨ì…˜ì„ ì œì‹œí–ˆë‹¤.** ê·¸ê²ƒì´ ë°”ë¡œ ë¦¬ì½”ì¼ì´ê³  ë‚˜ëŠ” ë¦¬ì½”ì¼ì— ëŒ€í•´ì„œ ì—¬ê¸°ì— ëª¨ë‘ ë‹´ëŠ”ê²ƒì´ ëª©í‘œì´ë‹¤.

<hr>

## ì¹´ìš´í„°

> (ì´ ë ˆí¬ì—ì„œ)ì²˜ìŒìœ¼ë¡œ ë§Œë“  ë¦¬ì½”ì¼ í”„ë¡œì íŠ¸ì´ë‹¤.

[ë§í¬](https://github.com/Hong-JunHyeok/Recoil_Study/tree/master/recoil_js_counter)

![image](https://user-images.githubusercontent.com/48292190/115545218-81db3b80-a2de-11eb-9535-5c9949f8bbe5.png)

# ğŸ¤¨ ë¦¬ì½”ì¼ì— ëŒ€í•´ì„œ...

# ë™ê¸°

ê¸°ì¡´ì— ë¦¬ì•¡íŠ¸ ìì²´ì ìœ¼ë¡œ ì§€ì›í•˜ë˜ ìƒíƒœê´€ë¦¬ ê¸°ëŠ¥ì„ ì‚¬ìš©í•´ë„ ë˜ì§€ë§Œ ë‹¨ì ì´ ìˆë‹¤.

- ì»´í¬ë„ŒíŠ¸ì˜ ìƒíƒœëŠ” ê³µí†µëœ ì¡°ìƒìœ¼ë¡œ ë„£ì–´ì•¼ ê³µìœ í•  ìˆ˜ ìˆì§€ë§Œ, ì´ê²ƒì€ ê±°ëŒ€í•œ íŠ¸ë¦¬ê°€ í¬í•¨ë˜ì–´ ë‹¤ì‹œ ë Œë”ë§ì„ í•´ì•¼í•œë‹¤.
- ContextëŠ” ë‹¨ì¼ ê°’ë§Œ ì €ì¥í•  ìˆ˜ ìˆìœ¼ë©° ìì²´ì ì¸ ì†Œë¹„ìê°€ ìˆëŠ” ì •ì˜ë˜ì§€ì•Šì€ ì§‘í•© ê°’ì€ ì €ì¥í•  ìˆ˜ ì—†ë‹¤.
- ì´ ë‘ê°€ì§€ê°€ íŠ¸ë¦¬ì˜ ìœ—ë¶€ë¶„ (stateê°€ ì¡´ì¬í•˜ëŠ” ê³³)ë¶€í„° íŠ¸ë¦¬ì˜ ì (stateê°€ ì‚¬ìš©ë˜ëŠ” ê³³)ê¹Œì§€ì˜ ì½”ë“œ ë¶„í• ì„ ì–´ë µê²Œí•œë‹¤.

ê·¸ë˜ì„œ ì´ë¥¼ ë³´ì™„í•˜ê³ ì Facebookì—ì„œëŠ” Recoilì´ë¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ê°œë°œí–ˆë‹¤.

Recoilì€ ì§êµí•˜ì§€ë§Œ ë³¸ì§ˆì ì¸ ë°©í–¥ ê·¸ë˜í”„ë¥¼ ì •ì˜í•˜ê³  React íŠ¸ë¦¬ì— ë¶™ì¸ë‹¤. ë‹¤ìŒê³¼ ê°™ì€ ì ‘ê·¼ ë°©ì‹ì„ í†µí•´ ìƒíƒœ ë³€í™”ëŠ” ì´ ê·¸ë˜í”„ì˜ ë¿Œë¦¬(atomsë¼ê³  ë¶€ë¥´ëŠ”)ì—ì„œ ìˆœìˆ˜í•¨ìˆ˜(selectorsë¼ê³  ë¶€ë¥´ëŠ” ê²ƒ)ë¥¼ ê±°ì³ ì»´í¬ë„ŒíŠ¸ë¡œ íë¥¸ë‹¤.

**ë¦¬ì½”ì¼ì˜ ì¥ì **

-ìš°ë¦¬ëŠ” ê³µìœ ë˜ëŠ” ìƒíƒœê°€ React ë‚´ë¶€ ìƒíƒœì™€ ë™ì¼í•œ ê°„ë‹¨í•œ get/set ì¸í„°í˜ì´ìŠ¤ë¥¼ ê°–ëŠ” boilerplate-free APIë¥¼ ì–»ëŠ”ë‹¤.(í•„ìš”í•œ ê²½ìš° reducers ë“±ìœ¼ë¡œ ìº¡ìŠí™”í•  ìˆ˜ ìˆë‹¤.)

-ìš°ë¦¬ëŠ” Concurrent ëª¨ë“œì™€ ì¶”í›„ ì‚¬ìš©ê°€ëŠ¥í•œ ë‹¤ë¥¸ ìƒˆë¡œ ì œê³µë˜ëŠ” Reactì˜ ê¸°ëŠ¥ê³¼ì˜ í˜¸í™˜ ê°€ëŠ¥ì„±ì„ ê°–ëŠ”ë‹¤.

-ìƒíƒœ ì •ì˜ëŠ” ì¦ë¶„ì ì´ê³  ë¶„ì‚°ë˜ì–´ ìˆì–´ ì½”ë“œ ë¶„í• ì´ ê°€ëŠ¥í•˜ë‹¤.

-ìƒíƒœë¥¼ ì‚¬ìš©í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ë¥¼ ìˆ˜ì •í•˜ì§€ ì•Šê³  íŒŒìƒëœ ë°ì´í„°ë¡œ ìƒíƒœë¥¼ ëŒ€ì²´í•  ìˆ˜ ìˆë‹¤.

-íŒŒìƒëœ ë°ì´í„°ëŠ” ê·¸ê²ƒì„ ì‚¬ìš©í•˜ëŠ” êµ¬ì„± ìš”ì†Œë¥¼ ìˆ˜ì •í•˜ì§€ ì•Šê³  ë™ê¸°ì‹ ë°ì´í„°ì™€ ë¹„ë™ê¸°ì‹ ì‚¬ì´ì—ì„œ ì´ë™í•  ìˆ˜ ìˆë‹¤.

-ìš°ë¦¬ëŠ” íƒìƒ‰ì„ ì¼ê¸‰ ê°œë…ìœ¼ë¡œ ì·¨ê¸‰í•  ìˆ˜ ìˆê³  ì‹¬ì§€ì–´ ë§í¬ì—ì„œ ìƒíƒœ ì „í™˜ì„ ì¸ì½”ë”©í•  ìˆ˜ë„ ìˆë‹¤.

-ì—­í˜¸í™˜ì„± ë°©ì‹ìœ¼ë¡œ ì „ì²´ ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœë¥¼ ìœ ì§€í•˜ê¸°ê°€ ì‰¬ìš°ë¯€ë¡œ ì§€ì†ëœ ìƒíƒœê°€ ì• í”Œë¦¬ì¼€ì´ì…˜ ë³€ê²½ì—ì„œ ì‚´ì•„ë‚¨ì„ ìˆ˜ ìˆë‹¤.

# ì£¼ìš” ê°œë…

**AtomsëŠ” ì»´í¬ë„ŒíŠ¸ê°€ êµ¬ë…í•  ìˆ˜ ìˆëŠ” ìƒíƒœì˜ ë‹¨ìœ„ë‹¤. Selectors ê°€ ì´ ìƒíƒœë¥¼ ë™ê¸° ë˜ëŠ” ë¹„ë™ê¸°ì‹ìœ¼ë¡œ ë³€í™˜í•œë‹¤.**

## Atoms

AtomsëŠ” ìƒíƒœì˜ ë‹¨ìœ„ë‹¤. ê·¸ê²ƒë“¤ì€ ì—…ë°ì´íŠ¸ì™€ êµ¬ë…ì´ ê°€ëŠ¥í•˜ë‹¤. atomì´ ì—…ë°ì´íŠ¸ë˜ë©´ ê°ê°ì˜ êµ¬ë…ëœ ì»´í¬ë„ŒíŠ¸ëŠ” ìƒˆë¡œìš´ ê°’ìœ¼ë¡œ ë‹¤ì‹œ ë Œë”ë§ ëœë‹¤.

```js
const fontSizeState = atom({
  key: "fontSizeState",
  default: 14,
});
```

AtomsëŠ” ë””ë²„ê¹…, ì§€ì†ì„±, ê·¸ë¦¬ê³  ëª¨ë“  atomë“¤ì˜ ë§µì„ ë³¼ ìˆ˜ ìˆëŠ” íŠ¹ì • ê³ ê¸‰ APIì— ì‚¬ìš©ë˜ëŠ” ê³ ìœ í•œ í‚¤ê°€ í•„ìš”í•˜ë‹¤. **ë‘ atomì´ ê°™ì€ í‚¤ë¥¼ ê°–ëŠ” ê²ƒì€ ì˜¤ë¥˜ì´ê¸° ë•Œë¬¸ì— ê·¸ê²ƒë“¤ì´ ì „ì—­ì ìœ¼ë¡œ ê³ ìœ í•˜ë‹¤ëŠ” ê²ƒì„ í™•ì‹¤í•˜ê²Œ í•´ì•¼ í•œë‹¤.** React ì»´í¬ë„ŒíŠ¸ì˜ ìƒíƒœì²˜ëŸ¼ ê¸°ë³¸ê°’ ë˜í•œ ê°€ì§€ê³  ìˆëŠ”ë‹¤.

ì»´í¬ë„ŒíŠ¸ì—ì„œ atomì„ ì½ê³  ì“°ë ¤ë©´ useRecoilStateë¼ëŠ” í‘ì„ ì‚¬ìš©í•œë‹¤. Reactì˜ useStateì™€ ê°™ì§€ë§Œ ì´ì œëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì»´í¬ë„ŒíŠ¸ë“¤ ì‚¬ì´ì—ì„œ ìƒíƒœë¥¼ ê³µìœ í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆë‹¤.

```js
function FontButton() {
  const [fontSize, setFontSize] = useRecoilState(fontSizeState);
  return (
    <button
      onClick={() => setFontSize((size) => size + 1)}
      style={{ fontSize }}
    >
      Click to Enlarge
    </button>
  );
}
```

ì´ì œ ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ fontSizeê°€ 1ì”© ì¦ê°€í•˜ëŠ” ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆë‹¤.

## Selectors

SelectorëŠ” atomì´ë‚˜ ë‹¤ë¥¸ selectorë¥¼ ì…ë ¥ìœ¼ë¡œ ë°›ì•„ë“¤ì´ëŠ” ìˆœìˆ˜í•œ í•¨ìˆ˜ë‹¤.

**ìƒìœ„ì˜ atom ë˜ëŠ” selectorê°€ ì—…ë°ì´íŠ¸ë˜ë©´ selector í•¨ìˆ˜ê°€ ì¬í‰ê°€ëœë‹¤. ì»´í¬ë„ŒíŠ¸ë“¤ì€ selectorë¥¼ atomì²˜ëŸ¼ êµ¬ë…í•  ìˆ˜ ìˆê³  selectorê°€ ë³€ê²½ë  ë•Œ ë‹¤ì‹œ ë Œë”ë§ì´ ì´ë£¨ì–´ì§„ë‹¤.**

SelectorëŠ” ìƒíƒœë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•˜ëŠ” íŒŒìƒ ë°ì´í„°ë¥¼ ê³„ì‚°í•˜ëŠ” ë° ì‚¬ìš©ëœë‹¤.

```js
const fontSizeLabelState = selector({
  key: "fontSizeLabelState",
  get: ({ get }) => {
    const fontSize = get(fontSizeState);
    const unit = "px";

    return `${fontSize}${unit}`;
  },
});
```

getì†ì„±ì€ ê³„ì‚°ë  í•¨ìˆ˜ë‹¤. getì¸ìë¥¼ í†µí•´ atomì˜ ê°’ì´ë‚˜ ë‹¤ë¥¸ selectorì— ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤.

```js
function FontButton() {
  const [fontSize, setFontSize] = useRecoilState(fontSizeState);
  const fontSizeLabel = useRecoilValue(fontSizeLabelState);

  return (
    <>
      <div>Current font size: ${fontSizeLabel}</div>

      <button onClick={setFontSize(fontSize + 1)} style={{ fontSize }}>
        Click to Enlarge
      </button>
    </>
  );
}
```

# ì„¤ì¹˜

[ì´ ë¬¸ì„œ](https://recoiljs.org/ko/docs/introduction/installation)ë¥¼ ì°¸ê³ í•´ì£¼ì„¸ìš”!

# RecoilRoot

"ì „ì—­"ì ìœ¼ë¡œ ìƒíƒœë¥¼ ê´€ë¦¬í•´ì•¼í•˜ë‹ˆê¹Œ `RecoilRoot`ê°€ í•„ìš”í•˜ë‹¤.

RecoilRootì˜ ìœ„ì¹˜ëŠ” ë£¨íŠ¸ ì»´í¬ë„ŒíŠ¸ê°€ ì œì¼ ì¢‹ë‹¤.

`index.js`ì˜ˆì‹œì´ë‹¤.

```js
import React from "react";
import ReactDOM from "react-dom";
import App from "./App";
import { RecoilRoot } from "recoil";

ReactDOM.render(
  <React.StrictMode>
    <RecoilRoot>
      <App />
    </RecoilRoot>
  </React.StrictMode>,
  document.getElementById("root")
);
```

ì´ëŸ¬ë©´ ì „ì—­ì ìœ¼ë¡œ recoilì„ ì‚¬ìš©í•  ì¤€ë¹„ê°€ ëœê²ƒì´ë‹¤.

# Atom

Atomì€ ìƒíƒœ(state)ì˜ ì¼ë¶€ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. AtomsëŠ” ì–´ë–¤ ì»´í¬ë„ŒíŠ¸ì—ì„œë‚˜ ì½ê³  ì“¸ ìˆ˜ ìˆë‹¤. atomì˜ ê°’ì„ ì½ëŠ” ì»´í¬ë„ŒíŠ¸ë“¤ì€ ì•”ë¬µì ìœ¼ë¡œ atomì„ êµ¬ë…í•œë‹¤. ê·¸ë˜ì„œ **atomì— ì–´ë–¤ ë³€í™”ê°€ ìˆìœ¼ë©´ ê·¸ atomì„ êµ¬ë…í•˜ëŠ” ëª¨ë“  ì»´í¬ë„ŒíŠ¸ë“¤ì´ ì¬ ë Œë”ë§ ë˜ëŠ” ê²°ê³¼ê°€ ë°œìƒí•  ê²ƒì´ë‹¤.**

```js
const textState = atom({
  key: "textState", // atomì˜ ê³ ìœ  ì•„ì´ë””
  default: "", // ê¸°ë³¸ ê°’
});
```

ì´ì œ ì»´í¬ë„ŒíŠ¸ê°€ atomì„ ì½ê³  ì“°ê²Œ í•˜ê¸° ìœ„í•´ì„œëŠ” useRecoilState()ë¥¼ ì•„ë˜ì™€ ê°™ì´ ì‚¬ìš©í•˜ë©´ ëœë‹¤.

```js
function CharacterCounter() {
  return (
    <div>
      <TextInput />
      <CharacterCount />
    </div>
  );
}

function TextInput() {
  const [text, setText] = useRecoilState(textState);

  const onChange = (event) => {
    setText(event.target.value);
  };

  return (
    <div>
      <input type="text" value={text} onChange={onChange} />
      <br />
      Echo: {text}
    </div>
  );
}
```

# Selector

SelectorëŠ” íŒŒìƒëœ ìƒíƒœ(derived state)ì˜ ì¼ë¶€ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. **íŒŒìƒëœ ìƒíƒœëŠ” ìƒíƒœì˜ ë³€í™”ë‹¤.** íŒŒìƒëœ ìƒíƒœë¥¼ ì–´ë–¤ ë°©ë²•ìœ¼ë¡œë“  ì£¼ì–´ì§„ ìƒíƒœë¥¼ ìˆ˜ì •í•˜ëŠ” ìˆœìˆ˜ í•¨ìˆ˜ì— ì „ë‹¬ëœ ìƒíƒœì˜ ê²°ê³¼ë¬¼ë¡œ ìƒê°í•  ìˆ˜ ìˆë‹¤.

```js
const charCountState = selector({
  key: "charCountState", // ê³ ìœ  ì•„ì´ë””
  get: ({ get }) => {
    const text = get(textState);

    return text.length;
  },
});
```

**useRecoilValue() í›…ì„ ì‚¬ìš©í•´ì„œ charCountState ê°’ì„ ì½ì„ ìˆ˜ ìˆë‹¤.**

```js
function CharacterCount() {
  const count = useRecoilValue(charCountState);

  return <>Character Count: {count}</>;
}
```

# ë³¸ê²©ì ì¸ Recoil í”„ë¡œì íŠ¸ ê°œë°œ

ì´ ì„¹ì…˜ì€ Recoilê³¼ Reactê°€ ì„¤ì¹˜í–ˆë‹¤ê³  ê°€ì •í•œë‹¤. ì•ìœ¼ë¡œì˜ ì„¹ì…˜ì˜ ì»´í¬ë„ŒíŠ¸ë“¤ì€ ë¶€ëª¨íŠ¸ë¦¬ì— `<RecoilRoot />`ê°€ ìˆë‹¤ê³  ê°€ì •í•œë‹¤.

- todo ì•„ì´í…œ ì¶”ê°€
- todo ì•„ì´í…œ ìˆ˜ì •
- todo ì•„ì´í…œ ì‚­ì œ
- todo ì•„ì´í…œ í•„í„°ë§
- ìœ ìš©í•œ í†µê³„ í‘œì‹œ

ì´ íŠœí† ë¦¬ì–¼ì—ì„œëŠ” ê°„ë‹¨í•œ **todo ë¦¬ìŠ¤íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜**ì„ ì œì‘í•œë‹¤.

**ê·¸ ê³¼ì •ì—ì„œ, ìš°ë¦¬ëŠ” Recoil APIì— ì˜í•´ ë…¸ì¶œëœ atoms, selectors, atom familiesì™€ hookë¥¼ ë‹¤ë£° ê²ƒì´ë‹¤. ìµœì í™” ë˜í•œ ë‹¤ë£° ê²ƒì´ë‹¤.**

AtomsëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœì˜ source of truthë¥¼ ê°–ëŠ”ë‹¤. todo ë¦¬ìŠ¤íŠ¸ì—ì„œ source of truthëŠ” todo ì•„ì´í…œì„ ë‚˜íƒ€ë‚´ëŠ” ê°ì²´ë¡œ ì´ë£¨ì–´ì§„ ë°°ì—´ì´ ë  ê²ƒì´ë‹¤.

ìš°ë¦¬ëŠ” atom ë¦¬ìŠ¤íŠ¸ë¥¼ todoListStateë¼ê³  í•˜ê³  ì´ê²ƒì„ atom() í•¨ìˆ˜ë¥¼ ì´ìš©í•´ ìƒì„±í•  ê²ƒì´ë‹¤.

```js
const todoListState = atom({
  key: "todoListState",
  default: [],
});
```

ì´ì œ todoListì½”ë“œë¥¼ ì‘ì„±í•œë‹¤.

ì „ì²´ ì†ŒìŠ¤ì½”ë“œë‹¤. ìì„¸í•œ ì„¤ëª…ì€ ì£¼ì„ìœ¼ë¡œ ë‹¬ê² ë‹¤.

```js
import { useState } from "react";
import { useRecoilValue, useSetRecoilState } from "recoil";
import todoListState from "./atom/todo"; //atomì„ ê°€ì ¸ì˜¨ë‹¤.

function App() {
  return (
    <div>
      <TodoList />
      {/*ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì¸ TodoListë¥¼ ë¶ˆëŸ¬ì˜¨ë‹¤.*/}
    </div>
  );
}

function TodoList() {
  const todoList = useRecoilValue(todoListState);
  //todoListë°°ì—´ì„ useRecoilValueë¥¼ ì´ìš©í•´ì„œ ê°€ì ¸ì˜¨ë‹¤.

  const mapTodoList = todoList.map((todoItem) => (
    <TodoItem key={todoItem.id} item={todoItem} />
  ));
  //ê°€ì ¸ì˜¨ todoë°°ì—´ì„ mappingí•´ì¤€ë‹¤.

  return (
    <>
      {/* <TodoListStats /> */}
      {/* <TodoListFilters /> */}
      <TodoItemCreator />
      <ul>{mapTodoList}</ul>
      {/* mappingí•œ todosë¥¼ ì¶œë ¥í•œë‹¤. */}
    </>
  );
}

function TodoItemCreator() {
  const [inputValue, setInputValue] = useState("");
  //todoë¥¼ ìƒì„±í• ë•Œ textì˜ inputê°’ì„ ìœ„í•œ stateì´ë‹¤.
  const setTodoList = useSetRecoilState(todoListState);
  //todoList atomì˜ setterí•¨ìˆ˜ë¥¼ ê°€ì ¸ì˜¨ë‹¤.

  //addItemí•¨ìˆ˜ëŠ” todoë¥¼ ì¶”ê°€í•˜ëŠ” í•¨ìˆ˜ì´ë‹¤.
  const addItem = () => {
    setTodoList((prevTodoList) => [
      ...prevTodoList,
      {
        id: getId(),
        text: inputValue,
        isComplete: false,
      },
    ]);
    // setTodoListë¥¼ ì‚¬ìš©í•´ì„œ ê¸°ì¡´ ë°°ì—´ì„ ë³µì‚¬í•˜ê³ , ìƒˆë¡œìš´ ë°°ì—´ì„ ë¶™ì¸ ê°’ì„ ë¦¬í„´í•œë‹¤.
    setInputValue("");
    //inputê°’ì„ ë¦¬í„´í•œë‹¤.
  };

  //onChangeí•¨ìˆ˜ëŠ” inputValueì˜ ê°’ì„ ë³€í™”ì‹œí‚¤ëŠ” í•¨ìˆ˜ì´ë‹¤.
  const onChange = (event) => {
    setInputValue(event.target.value);
    //event.target.valueëŠ” inputê°’ì˜ valueë¥¼ ì˜ë¯¸í•œë‹¤.
  };

  return (
    <div>
      <input type="text" value={inputValue} onChange={onChange} />
      <button onClick={addItem}>Add</button>
    </div>
  );
}

function TodoItem({ item }) {
  return <li>{item.text}</li>;
  //mappingí• ë•Œ í•„ìš”í•œ ì»´í¬ë„ŒíŠ¸ì´ë‹¤.
}

//getIdê°€ ë ë•Œë§ˆë‹¤ idë¥¼ ì¦ê°€ì‹œí‚¨ë‹¤.
//todoê°ì²´ì— idí•„ë“œë¥¼ ìœ„í•œ í•¨ìˆ˜ì´ë‹¤.
let id = 0;
const getId = () => {
  return id++;
};

export default App;
```

![image](https://user-images.githubusercontent.com/48292190/117094181-0bd6da00-ad9e-11eb-922f-b28045fcb7e8.png)

ì´ë ‡ê²Œ ì˜ ë‚˜ì˜¤ë©´ todolistì˜ ê¸°ë³¸ì ì¸ ê¸°ëŠ¥ì´ ì ìš©ì´ ëœê²ƒì´ë‹¤.
ì´ì œ selectorë¥¼ ì´ìš©í•´ì„œ todoë“¤ì„ filterí•˜ëŠ” ì‘ì—…ì„ í•´ë³´ë„ë¡ í•˜ê² ë‹¤.

**SelectorëŠ” íŒŒìƒëœ ìƒíƒœ(derived state)ì˜ ì¼ë¶€ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤.**

ìš°ë¦¬ê°€ selectorë¡œ ë§Œë“¤ ìƒíƒœëŠ” ì´ ë‘ê°œë‹¤.

- **í•„í„°ë§ ëœ todo ë¦¬ìŠ¤íŠ¸** : ì „ì²´ todo ë¦¬ìŠ¤íŠ¸ì—ì„œ ì¼ë¶€ ê¸°ì¤€ì— ë”°ë¼ íŠ¹ì • í•­ëª©ì´ í•„í„°ë§ ëœ ìƒˆ ë¦¬ìŠ¤íŠ¸(ì˜ˆ: ì´ë¯¸ ì™„ë£Œëœ í•­ëª© í•„í„°ë§)ë¥¼ ìƒì„±ë˜ì–´ íŒŒìƒëœë‹¤.

- **Todo ë¦¬ìŠ¤íŠ¸ í†µê³„** : ì „ì²´ todo ë¦¬ìŠ¤íŠ¸ì—ì„œ ëª©ë¡ì˜ ì´ í•­ëª© ìˆ˜, ì™„ë£Œëœ í•­ëª© ìˆ˜, ì™„ë£Œëœ í•­ëª©ì˜ ë°±ë¶„ìœ¨ ê°™ì€ ë¦¬ìŠ¤íŠ¸ì˜ ìœ ìš©í•œ ì†ì„±ë“¤ì„ ê³„ì‚°í•˜ì—¬ íŒŒìƒëœë‹¤.

```js
const todoListFilterState = atom({
  key: "todoListFilterState",
  default: "Show All",
});
```

ì—¬ê¸°ì„œ todoListFilterStateì˜ ê°’ì€ ë­˜ ì˜ë¯¸í•˜ëƒë©´ **í•„í„° ì˜µì…˜**ì„ ì˜ë¯¸í•œë‹¤.

"Show All", "Show Completed"ê³¼ "Show Uncompleted"ê°€ ìˆë‹¤.

ì´ì œ todoListStateì™€ todoListFilterState ë‘ê°œì˜ stateë¥¼ ê°€ì ¸ì™€ì„œ filterí•´ë³´ëŠ” ì‘ì—…ì„ í•´ë³´ì.

```js
const filteredTodoListState = selector({
  key: "filteredTodoListState",
  get: ({ get }) => {
    const filter = get(todoListFilterState);
    const list = get(todoListState);

    switch (filter) {
      case "Show Completed":
        return list.filter((item) => item.isComplete);
      case "Show Uncompleted":
        return list.filter((item) => !item.isComplete);
      default:
        return list;
    }
  },
});
```

> ì»´í¬ë„ŒíŠ¸ ê´€ì ì—ì„œ ë³´ë©´ selectorëŠ” atomì„ ì½ì„ ë•Œ ì‚¬ìš©í•˜ëŠ” ê°™ì€ í›…ì„ ì‚¬ìš©í•´ì„œ ì½ì„ ìˆ˜ ìˆë‹¤. ê·¸ëŸ¬ë‚˜ íŠ¹ì •í•œ í›…ì€ ì“°ê¸° ê°€ëŠ¥ ìƒíƒœ (ì¦‰, useRecoilState())ì—ì„œë§Œ ì‘ë™í•˜ëŠ” ì ì„ ìœ ì˜í•´ì•¼ í•œë‹¤. ëª¨ë“  atomì€ ì“°ê¸° ê°€ëŠ¥ ìƒíƒœì§€ë§Œ selectorëŠ” ì¼ë¶€ë§Œ ì“°ê¸° ê°€ëŠ¥í•œ ìƒíƒœ(getê³¼ set ì†ì„±ì„ ë‘˜ ë‹¤ ê°€ì§€ê³  ìˆëŠ” selector)ë¡œ ê°„ì£¼ëœë‹¤. ì´ ì£¼ì œì— ëŒ€í•´ì„œ ë” ë§ì€ ì •ë³´ë¥¼ ë³´ê³  ì‹¶ë‹¤ë©´ Core Concepts í˜ì´ì§€ë¥¼ ë³´ë©´ ëœë‹¤.

`filteredTodoListState`ëŠ” ë‚´ë¶€ì ìœ¼ë¡œ 2ê°œì˜ ì˜ì¡´ì„± `todoListFilterState`ì™€ `todoListState`ì„ ì¶”ì í•œë‹¤. ê·¸ë˜ì„œ ë‘˜ ì¤‘ í•˜ë‚˜ë¼ë„ ë³€í•˜ë©´ `filteredTodoListState`ëŠ” ì¬ ì‹¤í–‰ëœë‹¤.

ì´ì œ `TodoListFilters` ì»´í¬ë„ŒíŠ¸ë¥¼ ë§Œë“¤ì–´ë³´ì.

ìì„¸í•œ ì„¤ëª…ì„ ì£¼ì„ìœ¼ë¡œ ì„¤ëª…í•˜ê² ë‹¤.

```js
function TodoListFilters() {
  const [filter, setFilter] = useRecoilState(todoListFilterState);
  //todoListFilterState atomì„ ë¶ˆëŸ¬ì˜´. stateì™€ setterí•¨ìˆ˜ get

  const updateFilter = ({ target: { value } }) => {
    setFilter(value);
  };
  //select boxê°€ ë³€í• ë•Œë§ˆë‹¤ updateFilterí•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ë©´ì„œ, filter stateê°€ ë°”ë€œ

  return (
    <>
      Filter:
      <select value={filter} onChange={updateFilter}>
        <option value="Show All">All</option>
        <option value="Show Completed">Completed</option>
        <option value="Show Uncompleted">Uncompleted</option>
      </select>
    </>
  );
}
```

ì•„ë˜ëŠ” ì „ì²´ ì½”ë“œë‹¤.

```js
//todo.js
import { atom, selector } from "recoil";

export const todoListState = atom({
  key: "todoListState",
  default: [],
});

export const todoListFilterState = atom({
  key: "todoListFilterState",
  default: "Show All",
});

export const filteredTodoListState = selector({
  key: "filteredTodoListState",
  get: ({ get }) => {
    const filter = get(todoListFilterState);
    const list = get(todoListState);

    switch (filter) {
      case "Show Completed":
        return list.filter((item) => item.isComplete);
      case "Show Uncompleted":
        return list.filter((item) => !item.isComplete);
      default:
        return list;
    }
  },
});
```

```js
//app.js
import { useState } from "react";
import { useRecoilState, useRecoilValue, useSetRecoilState } from "recoil";
import {
  todoListState,
  todoListFilterState,
  filteredTodoListState,
} from "./atom/todo";

function App() {
  return (
    <div>
      <TodoList />
    </div>
  );
}

function TodoList() {
  const todoList = useRecoilValue(filteredTodoListState);

  const mapTodoList = todoList.map((todoItem) => (
    <TodoItem key={todoItem.id} item={todoItem} />
  ));

  return (
    <>
      {/* <TodoListStats /> */}
      <TodoListFilters />
      <TodoItemCreator />
      <ul>{mapTodoList}</ul>
    </>
  );
}

function TodoItemCreator() {
  const [inputValue, setInputValue] = useState("");
  const setTodoList = useSetRecoilState(todoListState);

  const addItem = () => {
    setTodoList((prevTodoList) => [
      ...prevTodoList,
      {
        id: getId(),
        text: inputValue,
        isComplete: false,
      },
    ]);
    setInputValue("");
  };

  const onChange = (event) => {
    setInputValue(event.target.value);
  };

  return (
    <div>
      <input type="text" value={inputValue} onChange={onChange} />
      <button onClick={addItem}>Add</button>
    </div>
  );
}

function TodoListFilters() {
  const [filter, setFilter] = useRecoilState(todoListFilterState);
  //todoListFilterState atomì„ ë¶ˆëŸ¬ì˜´. stateì™€ setterí•¨ìˆ˜ get

  const updateFilter = ({ target: { value } }) => {
    setFilter(value);
  };
  //select boxê°€ ë³€í• ë•Œë§ˆë‹¤ updateFilterí•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ë©´ì„œ, filter stateê°€ ë°”ë€œ

  return (
    <>
      Filter:
      <select value={filter} onChange={updateFilter}>
        <option value="Show All">All</option>
        <option value="Show Completed">Completed</option>
        <option value="Show Uncompleted">Uncompleted</option>
      </select>
    </>
  );
}

function TodoItem({ item }) {
  return <li>{item.text}</li>;
}

let id = 0;
const getId = () => {
  return id++;
};

export default App;
```

ê·¸ëŸ¬ë©´ ì •ìƒì ìœ¼ë¡œ í•„í„°ë§ì´ ì˜ ë˜ëŠ” ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆë‹¤.
![image](https://user-images.githubusercontent.com/48292190/117095374-2f4f5400-ada1-11eb-92cf-b74ff4f23edb.png)

ìš°ë¦¬ê°€ ì ì—…í•  ê¸°ëŠ¥ë“¤ì€

- todo í•­ëª©ë“¤ì˜ ì´ê°œìˆ˜
- ì™„ë£Œëœ todo í•­ëª©ë“¤ì˜ ì´ê°œìˆ˜
- ì™„ë£Œë˜ì§€ ì•Šì€ todo í•­ëª©ë“¤ì˜ ì´ê°œìˆ˜
- ì™„ë£Œëœ í•­ëª©ì˜ ë°±ë¶„ìœ¨

ì´ë‹¤.

í•„ìš”í•œ ë°ì´í„°ë¥¼ í¬í•¨í•˜ëŠ” ê°ì²´ë¥¼ ë°˜í™˜í•˜ëŠ” selector í•˜ë‚˜ë¥¼ ë§Œë“œëŠ” ê²ƒì´ ë” ì‰¬ìš´ ë°©ë²•ì¼ê²ƒì´ë‹¤.

```js
const todoListStatsState = selector({
  key: "todoListStatsState",
  get: ({ get }) => {
    const todoList = get(todoListState);
    const totalNum = todoList.length;
    const totalCompletedNum = todoList.filter((item) => item.isComplete).length;
    const totalUncompletedNum = totalNum - totalCompletedNum;
    const percentCompleted = totalNum === 0 ? 0 : totalCompletedNum / totalNum;

    return {
      totalNum,
      totalCompletedNum,
      totalUncompletedNum,
      percentCompleted,
    };
  },
});
```

ì•„ë˜ì™€ ê°™ì€ ë°©ë²•ìœ¼ë¡œ ë§ì´ë‹¤.

```js
function TodoListStats() {
  const {
    totalNum,
    totalCompletedNum,
    totalUncompletedNum,
    percentCompleted,
  } = useRecoilValue(todoListStatsState);

  const formattedPercentCompleted = Math.round(percentCompleted * 100);

  return (
    <ul>
      <li>Total items: {totalNum}</li>
      <li>Items completed: {totalCompletedNum}</li>
      <li>Items not completed: {totalUncompletedNum}</li>
      <li>Percent completed: {formattedPercentCompleted}</li>
    </ul>
  );
}
```

TodoListStatsë¥¼ í•˜ë‚˜ ë§Œë“¤ê³  ë Œë”ë§ì„ í•´ë³´ì.

![image](https://user-images.githubusercontent.com/48292190/117095722-14c9aa80-ada2-11eb-97c1-29b3e4e478bf.png)

ë§Œë“¤ë‹¤ë³´ë‹ˆ ê¹Œë¨¹ì€ê²Œ ìˆë‹¤...ì‚­ì œì™€ ìˆ˜ì •ì„ ì•ˆë§Œë“¤ì—ˆë‹¤...
í›„ë”± ë§Œë“¤ì–´ë³´ë„ë¡ í•˜ì

```js
function replaceItemAtIndex(arr, index, newValue) {
  return [...arr.slice(0, index), newValue, ...arr.slice(index + 1)];
}

function removeItemAtIndex(arr, index) {
  return [...arr.slice(0, index), ...arr.slice(index + 1)];
}
```

ìš°ì„  ìœ„ì™€ê°™ì´ ìˆ˜ì •, ì‚­ì œë¥¼ ìœ„í•œ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ì£¼ì.

replaceItemAtIndexì€ ìˆ˜ì • í•  indexë¥¼ ì¸ìë¡œ ë°›ê³  ê·¸ ì „ì˜ ë°°ì—´ê³¼ indexë’¤ì— ë°°ì—´ì„ ë³µì‚¬í•œ ë’¤, indexì˜ ê°’ì„ ë¼ì›Œë„£ëŠ”ë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.

removeItemAtIndexì€ ì‚­ì œí•  indexë¥¼ ì¸ìë¡œ ë°›ê³  ê·¸ ì „ì˜ ë°°ì—´ì„ ë³µì‚¬,indexë’¤ì˜ ë°°ì—´ì„ ë³µì‚¬ í›„ indexì˜ ê°’ì„ ì œì™¸í•˜ê² ë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.

ì´ì œ ë§Œë“¤ì—ˆìœ¼ë‹ˆê¹Œ ì‚¬ìš©í•´ë³´ë„ë¡ í•˜ì.

```js
import { useState } from "react";
import { useRecoilState, useRecoilValue, useSetRecoilState } from "recoil";
import {
  todoListState,
  todoListFilterState,
  filteredTodoListState,
  todoListStatsState,
} from "./atom/todo";

function App() {
  return (
    <div>
      <TodoList />
    </div>
  );
}

function TodoList() {
  const todoList = useRecoilValue(filteredTodoListState);

  const mapTodoList = todoList.map((todoItem) => (
    <TodoItem key={todoItem.id} item={todoItem} />
  ));

  return (
    <>
      <TodoListStats />
      <TodoListFilters />
      <TodoItemCreator />
      <ul>{mapTodoList}</ul>
    </>
  );
}

function TodoItemCreator() {
  const [inputValue, setInputValue] = useState("");
  const setTodoList = useSetRecoilState(todoListState);

  const addItem = () => {
    setTodoList((prevTodoList) => [
      ...prevTodoList,
      {
        id: getId(),
        text: inputValue,
        isComplete: false,
      },
    ]);
    setInputValue("");
  };

  const onChange = (event) => {
    setInputValue(event.target.value);
  };

  return (
    <div>
      <input type="text" value={inputValue} onChange={onChange} />
      <button onClick={addItem}>Add</button>
    </div>
  );
}

function TodoListFilters() {
  const [filter, setFilter] = useRecoilState(todoListFilterState);
  //todoListFilterState atomì„ ë¶ˆëŸ¬ì˜´. stateì™€ setterí•¨ìˆ˜ get

  const updateFilter = ({ target: { value } }) => {
    setFilter(value);
  };
  //select boxê°€ ë³€í• ë•Œë§ˆë‹¤ updateFilterí•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ë©´ì„œ, filter stateê°€ ë°”ë€œ

  return (
    <>
      Filter:
      <select value={filter} onChange={updateFilter}>
        <option value="Show All">All</option>
        <option value="Show Completed">Completed</option>
        <option value="Show Uncompleted">Uncompleted</option>
      </select>
    </>
  );
}

function TodoListStats() {
  const {
    totalNum,
    totalCompletedNum,
    totalUncompletedNum,
    percentCompleted,
  } = useRecoilValue(todoListStatsState);

  const formattedPercentCompleted = Math.round(percentCompleted * 100);

  return (
    <ul>
      <li>Total items: {totalNum}</li>
      <li>Items completed: {totalCompletedNum}</li>
      <li>Items not completed: {totalUncompletedNum}</li>
      <li>Percent completed: {formattedPercentCompleted}</li>
    </ul>
  );
}

function TodoItem({ item }) {
  const [toggleEdit, setToggleEdit] = useState(false);
  const [todoList, setTodoList] = useRecoilState(todoListState);
  const index = todoList.findIndex((listItem) => listItem === item);

  const editItemText = (event) => {
    const { value } = event.target;
    const newList = replaceItemAtIndex(todoList, index, {
      ...item,
      text: value,
    });

    setTodoList(newList);
  };

  const onEdit = () => {
    setToggleEdit(!toggleEdit);
  };

  const toggleItemCompletion = () => {
    const newList = replaceItemAtIndex(todoList, index, {
      ...item,
      isComplete: !item.isComplete,
    });

    setTodoList(newList);
  };

  const deleteItem = () => {
    const newList = removeItemAtIndex(todoList, index);

    setTodoList(newList);
  };

  return (
    <li>
      {toggleEdit && (
        <input type="text" value={item.text} onChange={editItemText} />
      )}
      {item.text}
      <input
        type="checkbox"
        checked={item.isComplete}
        onChange={toggleItemCompletion}
      />
      <button onClick={deleteItem}>X</button>
      <button onClick={onEdit}> {toggleEdit ? "ì™„ë£Œ" : "ìˆ˜ì •"} </button>
    </li>
  );
}

function replaceItemAtIndex(arr, index, newValue) {
  return [...arr.slice(0, index), newValue, ...arr.slice(index + 1)];
}

function removeItemAtIndex(arr, index) {
  return [...arr.slice(0, index), ...arr.slice(index + 1)];
}

let id = 0;
const getId = () => {
  return id++;
};

export default App;
```

![image](https://user-images.githubusercontent.com/48292190/117099971-7fccae80-adad-11eb-9eb8-f149060b53e3.png)


# ğŸŠ ì¶•í•˜í•©ë‹ˆë‹¤! ğŸŠ

íˆ¬ë‘ë¦¬ìŠ¤íŠ¸ ê°œë…ì„ ì™„ë²½íˆ ì´í•´í–ˆë‹¤ë©´, ë‹¹ì‹ ì€ atom , selectorë¥¼ ë§ˆìŠ¤í„°í–ˆìŠµë‹ˆë‹¤!
ì´ì œ ë¹„ë™ê¸° ë°ì´í„° ì¿¼ë¦¬ë¡œ ë„˜ì–´ê°€ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

# ë¹„ë™ê¸° ë°ì´í„° ì¿¼ë¦¬

